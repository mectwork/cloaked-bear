{% extends "BusetaBusesBundle::layout.html.twig" %}

{% form_theme form 'BusetaTemplateBundle:Widgets:collection_widget_archivo_adjunto.html.twig' %}

{% block nombre_menu_superior %}

{% endblock %}

{% block titulo_encabezado %}
    Adicionar nuevo autobús
{% endblock %}

{% block area_trabajo %}

    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <form action="{{ path('autobus_create') }}" method="post" {{ form_enctype(form) }}>
                {{ form_errors(form) }}
                    <!-- /.panel-heading -->
                    <div class="panel-body">
                        <!-- Nav tabs -->
                        <ul class="nav nav-tabs">
                            <li class="active">
                                <a href="#basicos" data-toggle="tab">Datos básicos</a>
                            </li>
                            <li>
                                <a href="#extras" data-toggle="tab">Información extra</a>
                            </li>
                            <li>
                                <a href="#filtros" data-toggle="tab">Filtros</a>
                            </li>
                            <li>
                                <a href="#imagenes" data-toggle="tab">Imágenes</a>
                            </li>
                            <li>
                                <a href="#otros" data-toggle="tab">Otros</a>
                            </li>
                        </ul>

                        <!-- Tab panes -->
                        <div class="tab-content">

                            <!-- TAB BASICOS-->
                            <div class="tab-pane fade in active" id="basicos">

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <label>Matrícula:</label>
                                        {{ form_widget(form.matricula) }}
                                        {{ form_errors(form.matricula) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Número:</label>
                                        {{ form_widget(form.numero) }}
                                        {{ form_errors(form.numero) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Número de Chasis:</label>
                                        {{ form_widget(form.numero_chasis) }}
                                        {{ form_errors(form.numero_chasis) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <label>Número de Motor:</label>
                                        {{ form_widget(form.numero_motor) }}
                                        {{ form_errors(form.numero_motor) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Peso Tara:</label>
                                        {{ form_widget(form.peso_tara) }}
                                        {{ form_errors(form.peso_tara) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Peso Bruto:</label>
                                        {{ form_widget(form.peso_bruto) }}
                                        {{ form_errors(form.peso_bruto) }}
                                    </div>
                                </div>

                                <div class="row show-grid">

                                    <div class="col-md-4">
                                        <label>Número de Plazas:</label>
                                        {{ form_widget(form.numero_plazas) }}
                                        {{ form_errors(form.numero_plazas) }}
                                    </div>
                                    <div class="col-md-4">
                                        <label>Número de Cilindros:</label>
                                        {{ form_widget(form.numero_cilindros) }}
                                        {{ form_errors(form.numero_cilindros) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Cilindrada:</label>
                                        {{ form_widget(form.cilindrada) }}
                                        {{ form_errors(form.cilindrada) }}
                                    </div>

                                </div>

                                <div class="row show-grid">

                                    <div class="col-md-4">
                                        <label>Potencia:</label>
                                        {{ form_widget(form.potencia) }}
                                        {{ form_errors(form.potencia) }}
                                    </div>
                                    <div class="col-md-4">
                                        <label>Fecha de Ingreso:</label>
                                        {{ form_widget(form.fecha_ingreso) }}
                                        {{ form_errors(form.fecha_ingreso) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Válido Hasta:</label>
                                        {{ form_widget(form.valido_hasta) }}
                                        {{ form_errors(form.valido_hasta) }}
                                    </div>

                                </div>

                                <div class="row show-grid">

                                    <div class="col-md-4">
                                        <label>Estilo:</label>
                                        {{ form_widget(form.estilo) }}
                                        {{ form_errors(form.estilo) }}
                                    </div>
                                    <div class="col-md-4">
                                        <label>Fecha RTV 1:</label>
                                        {{ form_widget(form.fecha_rtv_1) }}
                                        {{ form_errors(form.fecha_rtv_1) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Fecha RTV 2:</label>
                                        {{ form_widget(form.fecha_rtv_2) }}
                                        {{ form_errors(form.fecha_rtv_2) }}
                                    </div>

                                </div>

                                <div class="row show-grid">

                                    <div class="col-md-4">
                                        <label>Combustible:</label>
                                        {{ form_widget(form.combustible) }}
                                        {{ form_errors(form.combustible) }}
                                    </div>
                                    <div class="col-md-4">
                                        <label>Marca:</label>
                                        {{ form_widget(form.marca) }}
                                        {{ form_errors(form.marca) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Modelo:</label>
                                        {{ form_widget(form.modelo) }}
                                        {{ form_errors(form.modelo) }}
                                    </div>

                                </div>

                                <div class="row show-grid">

                                    <div class="col-md-4">
                                        <label>Color:</label>
                                        {{ form_widget(form.color) }}
                                        {{ form_errors(form.color) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Marca de Motor:</label>
                                        {{ form_widget(form.marca_motor) }}
                                        {{ form_errors(form.marca_motor) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Capacidad del Tanque en Litros:</label>
                                        {{ form_widget(form.capacidad_tanque) }}
                                        {{ form_errors(form.capacidad_tanque) }}
                                    </div>

                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label>
                                                <input id="rampas" type="checkbox" value=""><strong>Tiene Rampas</strong>
                                            </label>
                                        </div>
                                        <label id="rampas">Descripción de las Rampas:</label>
                                        {{ form_widget(form.rampas) }}
                                        {{ form_errors(form.rampas) }}
                                    </div>

                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label>
                                                <input id="barras" type="checkbox" value=""><strong>Tiene Barras</strong>
                                            </label>
                                        </div>
                                        <label id="barras">Descripción de Barras:</label>
                                        {{ form_widget(form.barras) }}
                                        {{ form_errors(form.barras) }}
                                    </div>

                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label>
                                                <input id="camaras" type="checkbox" value=""><strong>Tiene Cámaras</strong>
                                            </label>
                                        </div>
                                        <label id="camaras">Descripción de Cámaras:</label>
                                        {{ form_widget(form.camaras) }}
                                        {{ form_errors(form.camaras) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label>
                                                <input id="lector" type="checkbox" value=""><strong>Tiene Lector de Cédulas</strong>
                                            </label>
                                        </div>
                                        <label id="lector">Descripción del Lector de Cédulas:</label>
                                        {{ form_widget(form.lector_cedulas) }}
                                        {{ form_errors(form.lector_cedulas) }}
                                    </div>

                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label>
                                                <input id="publicidad" type="checkbox" value=""><strong>Tiene Publicidad</strong>
                                            </label>
                                        </div>
                                        <label id="publicidad">Descripción de la Publicidad:</label>
                                        {{ form_widget(form.publicidad) }}
                                        {{ form_errors(form.publicidad) }}
                                    </div>

                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label>
                                                <input id="gps" type="checkbox" value=""><strong>Tiene GPS</strong>
                                            </label>
                                        </div>
                                        <label id="gps" >Descripción de GPS:</label>
                                        {{ form_widget(form.gps) }}
                                        {{ form_errors(form.gps) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <div class="checkbox">
                                            <label>
                                                <input id="wifi" type="checkbox" value=""><strong>Tiene Wifi</strong>
                                            </label>
                                        </div>
                                        <label id="wifi">Descripción de Wifi:</label>
                                        {{ form_widget(form.wifi) }}
                                        {{ form_errors(form.wifi) }}
                                    </div>
                                </div>

                        </div>

                            <!-- TAB EXTRAS-->
                            <div class="tab-pane fade" id="extras">

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <label>N&uacute;mero de Unidad:</label>
                                        {{ form_widget(form.numero_unidad) }}
                                        {{ form_errors(form.numero_unidad) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Valor Unidad:</label>
                                        {{ form_widget(form.valor_unidad) }}
                                        {{ form_errors(form.valor_unidad) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Año:</label>
                                        {{ form_widget(form.anno) }}
                                        {{ form_errors(form.anno) }}
                                    </div>

                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <label>Marca Caja de Cambio:</label>
                                        {{ form_widget(form.marca_cajacambio) }}
                                        {{ form_errors(form.marca_cajacambio) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Tipo Caja de Cambio:</label>
                                        {{ form_widget(form.tipo_cajacambio) }}
                                        {{ form_errors(form.tipo_cajacambio) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Carter Capacidad en Litros:</label>
                                        {{ form_widget(form.carter_capacidadlitros) }}
                                        {{ form_errors(form.carter_capacidadlitros) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <label>Aceite Caja de Cambios:</label>
                                        {{ form_widget(form.aceitecajacambios) }}
                                        {{ form_errors(form.aceitecajacambios) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Aceite Hidráulico:</label>
                                        {{ form_widget(form.aceitehidraulico) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Aceite de Motor:</label>
                                        {{ form_widget(form.aceitemotor) }}
                                        {{ form_errors(form.aceitemotor) }}
                                    </div>

                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-4">
                                        <label>Aceite de Transmisión:</label>
                                        {{ form_widget(form.aceitetransmision) }}
                                        {{ form_errors(form.aceitetransmision) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Batería 1:</label>
                                        {{ form_widget(form.bateria_1) }}
                                        {{ form_errors(form.bateria_1) }}
                                    </div>

                                    <div class="col-md-4">
                                        <label>Batería 2:</label>
                                        {{ form_widget(form.bateria_2) }}
                                        {{ form_errors(form.bateria_2) }}
                                    </div>
                                </div>

                            </div>

                            <!-- TAB FILTROS-->
                            <div class="tab-pane fade" id="filtros">
                                <div class="row show-grid">
                                    <div class="col-md-3">
                                        <label>Filtro de Caja:</label>
                                        {{ form_widget(form.filtro_caja.filtro_caja_1) }}
                                        {{ form_errors(form.filtro_caja.filtro_caja_1) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_caja.filtro_caja_2) }}
                                        {{ form_errors(form.filtro_caja.filtro_caja_2) }}
                                    </div>

                                    <div class="col-md-3">
                                        <label>Filtro de Transmisión</label>
                                        {{ form_widget(form.filtro_transmision.filtro_transmision) }}
                                        {{ form_errors(form.filtro_transmision.filtro_transmision) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-3">
                                        <label>Filtro de Agua:</label>
                                        {{ form_widget(form.filtro_agua.filtro_agua_1) }}
                                        {{ form_errors(form.filtro_agua.filtro_agua_1) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_agua.filtro_agua_2) }}
                                        {{ form_errors(form.filtro_agua.filtro_agua_2) }}
                                    </div>

                                    <div class="col-md-3">
                                        <label>Filtro de Hidráulico:</label>
                                        {{ form_widget(form.filtro_hidraulico.filtro_hidraulico_1) }}
                                        {{ form_errors(form.filtro_hidraulico.filtro_hidraulico_1) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_hidraulico.filtro_hidraulico_2) }}
                                        {{ form_errors(form.filtro_hidraulico.filtro_hidraulico_2) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-3">
                                        <label>Filtro de Diesel:</label>
                                        {{ form_widget(form.filtro_diesel.filtro_diesel_1) }}
                                        {{ form_errors(form.filtro_diesel.filtro_diesel_1) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_diesel.filtro_diesel_2) }}
                                        {{ form_errors(form.filtro_diesel.filtro_diesel_2) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_diesel.filtro_diesel_3) }}
                                        {{ form_errors(form.filtro_diesel.filtro_diesel_3) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_diesel.filtro_diesel_4) }}
                                        {{ form_errors(form.filtro_diesel.filtro_diesel_4) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-3">
                                        <label>Filtro de Aceite:</label>
                                        {{ form_widget(form.filtro_aceite.filtro_aceite_1) }}
                                        {{ form_errors(form.filtro_aceite.filtro_aceite_1) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_aceite.filtro_aceite_2) }}
                                        {{ form_errors(form.filtro_aceite.filtro_aceite_2) }}
                                    </div>
                                    <div class="col-md-3">
                                        <label>&nbsp;</label>
                                        {{ form_widget(form.filtro_aceite.filtro_aceite_3) }}
                                        {{ form_errors(form.filtro_aceite.filtro_aceite_3) }}
                                    </div>
                                </div>
                            </div>

                            <!-- TAB IMAGENES-->
                            <div class="tab-pane fade" id="imagenes">

                                <div class="row show-grid">
                                    <div class="col-md-6">
                                        <label>Vista Frontal:</label>
                                        {{ form_widget(form.imagen_frontal) }}
                                        {{ form_errors(form.imagen_frontal) }}
                                    </div>

                                    <div class="col-md-6">
                                        <label>Vista Trasera:</label>
                                        {{ form_widget(form.imagen_trasera) }}
                                        {{ form_errors(form.imagen_trasera) }}
                                    </div>
                                </div>

                                <div class="row show-grid">
                                    <div class="col-md-6">
                                        <label>Vista Lateral Izquierda:</label>
                                        {{ form_widget(form.imagen_lateral_i) }}
                                        {{ form_errors(form.imagen_lateral_i) }}
                                    </div>

                                    <div class="col-md-6">
                                        <label>Vista Lateral Derecha:</label>
                                        {{ form_widget(form.imagen_lateral_d) }}
                                        {{ form_errors(form.imagen_lateral_d) }}
                                    </div>
                                </div>

                                {# form_widget(form.archivo_adjunto) #}

                            </div>

                            <!-- TAB OTROS-->
                            <div class="tab-pane fade" id="otros">
                                <div class="row show-grid">
                                    <div class="col-md-6">
                                        <label>Kilometraje:</label>
                                        {{ form_widget(form.kilometraje) }}
                                        {{ form_errors(form.kilometraje) }}
                                    </div>

                                    <div class="col-md-6">
                                        <label>Horas:</label>
                                        {{ form_widget(form.horas) }}
                                        {{ form_errors(form.horas) }}
                                    </div>
                                </div>
                            </div>

                        </div>
                    <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->

                    <div class="row show-grid">
                        <div class="col-md-4">

                            <input class="btn btn-primary" style="height: 34px" type="submit" value="Aceptar">
                            <div class="btn-group">
                                <a class="btn btn-primary" href="{{ path('autobus') }}"> Cancelar</a>
                            </div>
                        </div>
                    </div>

                    {{ form_rest(form) }}
                </form>
            </div>
        <!-- /.col-lg-6 -->
        </div>
    </div>

{% endblock %}

{% block contenido %}

{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script type="text/javascript">
        $('.date').datetimepicker({
            format: 'DD/MM/YYYY',
            pickTime: false
        });

    </script>

    <script src="{{ asset('bundles/busetabuses/js/checkClick.js') }}"></script>

    <script type="text/javascript">
        var collectionHolder = $('table#buseta_databundle_autobus_archivo_adjunto');
        var $addTagLink = $('a.add_tag_link');

        jQuery(document).ready(function() {
            // count the current form inputs we have (e.g. 2), use that as the new
            // index when inserting a new item (e.g. 2)
            collectionHolder.data('index', collectionHolder.find('a.delete_tag_link').length);

            $addTagLink.on('click', function(e) {
                // prevent the link from creating a "#" on the URL
                e.preventDefault();

                // add a new tag form (see next code block)
                addTagForm(collectionHolder);
            });

            updateDeleteLink();
            updateView();

            function addTagForm(collectionHolder) {
                // Get the data-prototype explained earlier
                var prototype = collectionHolder.data('prototype');

                // get the new index
                var index = collectionHolder.data('index');

                // Replace '__name__' in the prototype's HTML to
                // instead be a number based on how many items we have
                var newForm = prototype.replace(/__name__/g, index);

                // increase the index with one for the next item
                collectionHolder.data('index', index + 1);

                // Display the form in the page in an li, before the "Add a tag" link li
                var $newFormDiv = $('<tr></tr>').append(newForm);
                collectionHolder.find('tbody').append($newFormDiv);
                updateDeleteLink();
                updateView();
            }

            function updateDeleteLink(){
                $('a.delete_tag_link').on('click', function(e) {
                    // prevent the link from creating a "#" on the URL
                    e.preventDefault();

                    // remove the li for the tag form
                    $(this).parent().parent().remove();
                    updateView();
                });
            }

            function updateView(){
                counter = collectionHolder.find('a.delete_tag_link').length;
                if(counter == 0){
                    $('tr#no-elements-tr').show();
                }else{
                    $('tr#no-elements-tr').hide();
                }
            }
        });

        //Actualiza los Modelos a partir de las Marcas seleccionados con peticiones AJAX
        $('#{{ form.marca.vars.id }}').change(function(){
            var data = {
                marca_id: $(this).val()
            };

            $.ajax({
                type: 'GET',
                url: '{{ path("autobus_ajax_marca_modelo") }}',
                data: data,
                success: function(data) {
                    var values = $.parseJSON(data);
                    var $modelo_selector = $('#{{ form.modelo.vars.id }}');

                    $modelo_selector.html('<option>---Seleccione---</option>');

                    for (var i=0, total = values.length; i < total; i++) {
                        $modelo_selector.append('<option value="' + values[i].id + '">' + values[i].valor + '</option>');
                    }
                }
            });
        });

    </script>
{% endblock javascripts %}
